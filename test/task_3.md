Задача #3

Вам дан набор данных, представляющих геопозиции курьера, собранные с GPS- маячка, установленного на его электровелосипеде. Маячок собирает данные каждые 20 секунд. Из-за плотной застройки и различных помех данные могут быть неточными, с погрешностью до 50
метров, особенно в местах парковки.
Предложите алгоритм для обработки данных геопозиций курьера с целью построения его маршрута на карте. Алгоритм должен минимизировать резкие скачки в данных и максимально точно отражать реальный маршрут курьера.


Достаточно описать шаги алгоритма решения задачи.

Ответ:

1. Cбор и сохранение данных
  - координаты longitude, latitude
  - расстояние до предыдущей точки
  - время между точками
  - скорость перемещения
  - медианные координаты, для сглаживания маршрута, по 3 точкам
  - медианная скорость движения, по 5 точкам (по скользящему окну)
  - p90, 90-й процентиль скорости (для отсечения выбросов) — значение скорости, ниже которого находится 90% всех измерений скорости за рассматриваемый период, окно для подсчета процентиля лучше подогнать на реальных данных
  - статус точки, новые данные присваиваем статус, статус данных меняется после анализа последующих точке
  - направление движения

2. Фильтрация выбросов
  Если
    - скорость резко превышает ожидаемую (например, p90x2)
    - расстояние до предыдущей точки >100м за 20 сек

  помечаем статус точки как unclear

3. Сегментация поездок, выделяем поездки и остановки по следующим условиям.
  - новый сегмент если между точками прошло больше 10 минут после предыдущей точки
  - расстояние между последней и новой точкой превышает допустимое
  - остановка если подряд идёт серия точек со скоростью ниже порога, например, меньше 1 метра в секунду  и таких точек не меньше, например, 5

4. Анализ и подтверждение точек
  Каждая pending-точка получает статус:
  - approved, если она не выбивается по скорости/направлению
  - unclear, если она выбивается из общего паттерна и не поддерживается последующими точками
  - pending если последующих данных не достаточно